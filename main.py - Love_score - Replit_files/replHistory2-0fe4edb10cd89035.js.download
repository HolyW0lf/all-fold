(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4487],{93061:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/replHistory2",function(){return t(98269)}])},41709:function(e,n,t){"use strict";t.d(n,{q:function(){return R},J:function(){return E}});var r=t(26042),i=t(99534),o=t(10253),l=t(35944),a=t(51438),u=t(28668),s=t(25171),c=t(78120),f=t(14456),d=t(99094),h=f.tk.baseTheme({".cm-diff-inserted":{backgroundColor:"#0053A644",borderLeft:"#0053A6 solid 3px"},".cm-diff-deleted":{backgroundColor:"#c93c3733",borderLeft:"#c93c37 solid 3px"}}),v=f.p.line({attributes:{class:"cm-diff-inserted"}}),p=f.p.line({attributes:{class:"cm-diff-deleted"}}),g=c.Py.define({map:function(e,n){return e.map(n)}}),m=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(){return(0,a.Z)(this,t),n.apply(this,arguments)}var r=t.prototype;return r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-alignment cm-line",e.innerHTML="&nbsp;",e},r.ignoreEvent=function(){return!1},t}(f.l9);function w(e){var n=new c.f_,t=new m;e.sort((function(e,n){return e.character-n.character}));var r=!0,i=!1,o=void 0;try{for(var l,a=e[Symbol.iterator]();!(r=(l=a.next()).done);r=!0)for(var u=l.value,s=u.character,d=u.padding,h=0;h<d;h++)n.add(s,s,f.p.widget({widget:t,side:-1,block:!0}))}catch(v){i=!0,o=v}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n.finish()}function Z(e){var n=e.coloredLines,t=e.colorDecoration,r=f.lg.fromClass((function e(r){(0,a.Z)(this,e);var i=new c.f_,o=!0,l=!1,u=void 0;try{for(var s,f=n[Symbol.iterator]();!(o=(s=f.next()).done);o=!0){var d=s.value,h=r.state.doc.line(d);i.add(h.from,h.from,t)}}catch(v){l=!0,u=v}finally{try{o||null==f.return||f.return()}finally{if(l)throw u}}this.decorations=i.finish()}),{decorations:function(e){return e.decorations}}),i=c.QQ.define({create:function(){return f.p.none},update:function(e,n){var t=!0,r=!1,i=void 0;try{for(var o,l=n.effects[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var a=o.value;if(a.is(g))return a.value}}catch(u){r=!0,i=u}finally{try{t||null==l.return||l.return()}finally{if(r)throw i}}return n.docChanged?e.map(n.changes):e},provide:function(e){return f.tk.decorations.from(e)}});return[h,r,i]}var y=function(){var e=function(e,n){return f.tk.domEventHandlers({scroll:function(t,r){if(r===e&&t.target){var i=t.target;if(i.scrollTop){var o=i.scrollTop;n.scrollDOM.scrollTo({top:o})}}}})},n=new c.F6,t=new c.F6;return{extensions:function(){return{right:n.of([]),left:t.of([])}},setup:function(r,i){r.dispatch({effects:t.reconfigure(e(r,i))}),i.dispatch({effects:n.reconfigure(e(i,r))})}}},b=t(67294),x=t(80159),C=t(78244),k=y(),P=k.extensions,S=k.setup;function E(e){var n=e.left,t=e.right,l=n.code,a=(0,i.Z)(n,["code"]),u=t.code,s=(0,i.Z)(t,["code"]),f=(0,x.Z)((0,r.Z)({readOnly:!0,lineWrapping:!1,initialDoc:l,extensions:[P().left]},a)),h=f.view,m=f.ref,y=(0,x.Z)((0,r.Z)({readOnly:!0,lineWrapping:!1,initialDoc:u,extensions:[P().right]},s)),C=y.view,k=y.ref,E=(0,o.Z)(b.useState(!1),2),R=E[0],T=E[1],L=(0,o.Z)(b.useState(!1),2),B=L[0],I=L[1];return b.useEffect((function(){if(h&&C&&R&&B){var e=setTimeout((function(){S(h,C),function(e,n){var t=(0,d.Bz)(e.state.doc.sliceString(0),n.state.doc.sliceString(0));e.dispatch({effects:[c.Py.appendConfig.of(Z({coloredLines:t.leftColored.sort((function(e,n){return e-n})),colorDecoration:p})),g.of(w(t.leftPadded))]}),n.dispatch({effects:[c.Py.appendConfig.of(Z({coloredLines:t.rightColored.sort((function(e,n){return e-n})),colorDecoration:v})),g.of(w(t.rightPadded))]})}(h,C)}));return function(){return clearTimeout(e)}}}),[h,C,R,B]),b.useEffect((function(){h&&(h.dispatch({changes:{from:0,to:h.state.doc.length,insert:l}}),T(!0))}),[l,h]),b.useEffect((function(){C&&(C.dispatch({changes:{from:0,to:C.state.doc.length,insert:u}}),I(!0))}),[u,C]),{left:{view:h,ref:m,code:l,options:a,ready:R},right:{view:C,ref:k,code:u,options:s,ready:B}}}function R(e){var n,t=e.diffViewer,o=(0,i.Z)(e,["diffViewer"]);return(0,l.BX)(l.HY,{children:[(0,l.tZ)("div",{css:{height:t.ready?0:"auto"},ref:t.ref}),!t.ready&&(0,l.tZ)(C.PH,(0,r.Z)({code:null!==(n=t.code)&&void 0!==n?n:""},t.options,o))]})}},99094:function(e,n,t){"use strict";t.d(n,{Bz:function(){return g},PO:function(){return m}});var r=t(51438),i=t(10253),o=t(34051),l=t.n(o),a=t(52027),u=t.n(a),s=u().DIFF_DELETE,c=u().DIFF_INSERT,f=u().DIFF_EQUAL;function d(e,n){var t=new(u()),r=t.diff_linesToChars_(e,n),i=r.chars1,o=r.chars2,l=r.lineArray,a=t.diff_main(i,o,!1);return t.diff_charsToLines_(a,l),a}function h(e){return e.split("\n").length-1}function v(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===n)return 0;var r=e.indexOf("\n",t);return-1===r?null:1===n?r+1:v(e,n-1,r+1)}function p(e,n,t){if(e>0){var r=v(t,n);if(null!==r)return{lineNumber:n,character:r,padding:e}}return null}function g(e,n){for(var t,r,o=d(e+((t="\n"===e[e.length-1])?"":"\n"),n+((r="\n"===n[n.length-1])?"":"\n")),l=0,a=0,u=[],v=[],g=[],m=[],w=0,Z=0,y=0;y<o.length;y++){var b=(0,i.Z)(o[y],2),x=b[0],C=h(b[1]);switch(x){case s:var k,P=(0,i.Z)(null!==(k=o[y+1])&&void 0!==k?k:[],2),S=P[0],E=P[1];l+=C;for(var R=0;R<C;R++)u.push(l-R);var T=C;S===c&&(T-=h(E));var L=p(T,a,n);L&&m.push(L);break;case c:var B,I=(0,i.Z)(null!==(B=o[y-1])&&void 0!==B?B:[],2),U=I[0],N=I[1];a+=C;for(var G=0;G<C;G++)v.push(a-G);var X=C;U===s&&(X-=h(N));var D=p(X,l,e);D&&g.push(D);break;case f:a>Z&&(Z=a),l>w&&(w=l),l+=C,a+=C}}var O=g.filter((function(e){return e.lineNumber<Z})),_=m.filter((function(e){return e.lineNumber<w}));return{leftPadded:O,rightPadded:_,leftColored:u,rightColored:v,changedTrailingNewline:t!==r,leftTrailingNewline:t,rightTrailingNewline:r}}var m=function(){function e(n,t){(0,r.Z)(this,e),this.deleted=new Set,this.inserted=new Map,this.linePositions=new Map,this.lineLengths=new Map,this.currentTrailingNewline="\n"===n[n.length-1],this.otherTrailingNewline="\n"===t[t.length-1],this.changedTrailingNewline=this.currentTrailingNewline!==this.otherTrailingNewline;var o=d(n,t),l=[],a=!0,u=!1,h=void 0;try{for(var v,p=o[Symbol.iterator]();!(a=(v=p.next()).done);a=!0){var g=(0,i.Z)(v.value,2),m=g[0],w=g[1].split("\n");""===w[w.length-1]&&w.pop();var Z=!0,y=!1,b=void 0;try{for(var x,C=w[Symbol.iterator]();!(Z=(x=C.next()).done);Z=!0){var k=x.value;l.push([m,k])}}catch(O){y=!0,b=O}finally{try{Z||null==C.return||C.return()}finally{if(y)throw b}}}}catch(O){u=!0,h=O}finally{try{a||null==p.return||p.return()}finally{if(u)throw h}}this.currentTrailingNewline&&!this.otherTrailingNewline?l.push([s,""]):!this.currentTrailingNewline&&this.otherTrailingNewline?l.push([c,""]):this.currentTrailingNewline&&this.otherTrailingNewline&&l.push([f,""]);var P=1,S=0,E=1,R=!0,T=!1,L=void 0;try{for(var B,I=l[Symbol.iterator]();!(R=(B=I.next()).done);R=!0){var U=(0,i.Z)(B.value,2),N=U[0],G=U[1];switch(N){case s:this.linePositions.set(P,S),this.lineLengths.set(P,G.length),this.deleted.add(P),S+=G.length+1,P++;break;case c:var X=P-1,D=this.inserted.get(X);D||(D=[],this.inserted.set(X,D)),D.push({number:E,content:G}),E++;break;case f:this.linePositions.set(P,S),this.lineLengths.set(P,G.length),S+=G.length+1,P++,E++}}}catch(O){T=!0,L=O}finally{try{R||null==I.return||I.return()}finally{if(T)throw L}}}var n=e.prototype;return n.startInsertions=function(){var e=this.inserted.get(0);return e&&0!==e.length?e:null},n.lineIsDeleted=function(e){return this.deleted.has(e)},n.lineInsertions=function(e){var n=this.inserted.get(e);return n&&0!==n.length?n:null},n.lineInsertedContent=function(e){var n=this.lineInsertions(e);return n?n.map((function(e){return e.content})).join("\n"):null},n.offsetFor=function(e){var n,t,r=0;r+=null!==(t=null===(n=this.inserted.get(0))||void 0===n?void 0:n.length)&&void 0!==t?t:0;for(var i=1;i<e;i++){this.lineIsDeleted(i)&&r--;var o=this.lineInsertions(i);o&&(r+=o.length)}return r},n.linePosition=function(e){var n;return null!==(n=this.linePositions.get(e))&&void 0!==n?n:null},n.lineLength=function(e){var n;return null!==(n=this.lineLengths.get(e))&&void 0!==n?n:null},n.line=function(e){var n=this.linePosition(e),t=this.lineLength(e);return null===n||null===t?null:{number:e,from:n,to:n+t,length:t,offset:this.offsetFor(e),isDeleted:this.lineIsDeleted(e),insertions:this.lineInsertions(e)}},n.lines=l().mark((function e(){var n,t,r,o,a,u,s,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,t=!1,r=void 0,e.prev=1,o=this.linePositions[Symbol.iterator]();case 3:if(n=(a=o.next()).done){e.next=13;break}if(u=(0,i.Z)(a.value,1),s=u[0],c=this.line(s)){e.next=8;break}throw new Error("line should not be null");case 8:return e.next=10,c;case 10:n=!0,e.next=3;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),t=!0,r=e.t0;case 19:e.prev=19,e.prev=20,n||null==o.return||o.return();case 22:if(e.prev=22,!t){e.next=25;break}throw r;case 25:return e.finish(22);case 26:return e.finish(19);case 27:case"end":return e.stop()}}),e,this,[[1,15,19,27],[20,,22,26]])})),e}()},74591:function(e,n,t){"use strict";var r=t(35944),i=(t(67294),t(69346)),o=t(1144),l=t(81255),a=t(15085),u=t(57704);n.Z=function(e){return(0,r.BX)(i.Z,{css:[l.l0.colWithGap(24)],children:[(0,r.BX)(o.h,{variant:"headerDefault",level:2,children:["Delete ",e.name||e.entityType]}),(0,r.BX)(o.x,{multiline:!0,children:["Are you sure you want to delete this ",e.entityType,"? This cannot be undone."]}),(0,r.BX)(i.Z,{css:[l.l0.rowWithGap(12),l.l0.justify.end],children:[(0,r.tZ)(a.zx,{text:"Cancel",onClick:e.hideModal}),(0,r.tZ)(a.zx,{dataCy:"delete-modal-confirm-button",iconLeft:(0,r.tZ)(u.Z,{}),onClick:function(){e.delete(),e.hideModal()},text:"Yes, delete this ".concat(e.entityType),colorway:"negative"})]})]})}},52008:function(e,n,t){"use strict";t.d(n,{JM:function(){return d},SL:function(){return c}});var r=t(26042),i=t(7297),o=t(31230),l=t(37887);function a(){var e=(0,i.Z)(['\n  fragment ReplEnvironment2CurrentUserLayoutFlags on CurrentUser {\n    id\n    flagSaveLayoutState: gate(feature: "flag-save-layout-state")\n    flagThreadsPane: gate(feature: "flag-threads-pane")\n    flagThreads2: gate(feature: "flag-threads-2")\n    flagGhostrunner: gate(feature: "flag-ghostrunner")\n    flagLayoutNavigator: gate(feature: "flag-layout-navigator")\n  }\n']);return a=function(){return e},e}function u(){var e=(0,i.Z)(["\n  query ReplEnvironment2LayoutFlags {\n    currentUser {\n      id\n      ...ReplEnvironment2CurrentUserLayoutFlags\n    }\n  }\n  ","\n"]);return u=function(){return e},e}var s={},c=(0,o.Ps)(a()),f=(0,o.Ps)(u(),c);function d(e){var n=(0,r.Z)({},s,e);return l.a(f,n)}},23600:function(e,n,t){"use strict";t.d(n,{p:function(){return r}});var r=16546464e5},78539:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(67294);function i(e){var n=e.children,t=(0,r.useState)(!0),i=t[0],o=t[1];return(0,r.useEffect)((function(){o(!1)}),[]),i?null:n}},61957:function(e,n,t){"use strict";t.d(n,{HJ:function(){return u},UK:function(){return c},ZK:function(){return h}});var r=t(59637),i=t(29815),o=t(82222),l=t(51207),a=t(37756);function u(e){var n=[],t="",r=!0,i=!1,l=void 0;try{for(var u,s=e[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value,h=c.op,v=c.userId,p=c.timestamp,g=[],m=0,w=!0,Z=!1,y=void 0;try{for(var b,x=h[Symbol.iterator]();!(w=(b=x.next()).done);w=!0){var C=b.value;switch("undefined"===typeof C?"undefined":(0,o.Z)(C)){case"object":g.push({d:t.slice((0,a.uniToStrPos)(t,m),(0,a.uniToStrPos)(t,m+C.d))}),m+=C.d;break;case"string":g.push(C);break;case"number":g.push(C),m+=C}}}catch(k){Z=!0,y=k}finally{try{w||null==x.return||x.return()}finally{if(Z)throw y}}n.push({userId:v,timestamp:p,op:g}),t=d(t,1===n.length?f(h):h)}}catch(k){i=!0,l=k}finally{try{r||null==s.return||s.return()}finally{if(i)throw l}}return n}function s(e){return e.map((function(e){return e.op.map((function(e){switch("undefined"===typeof e?"undefined":(0,o.Z)(e)){case"object":return e.d;case"string":return{d:(0,a.strPosToUni)(e)};case"number":return e}}))}))}function c(e,n){v(e,n);var t=(0,r.Z)(s(n.slice(e,n.length).reverse())),i=t[0];return t.slice(1).reduce((function(e,n){return l.dt.compose(e,n)}),i)}function f(e){return e.filter((function(e){return!function(e){return"string"===typeof e&&0===e.length}(e)}))}function d(e,n){return l.dt.apply(e,n)}function h(e,n,t,r){if(v(n,r),v(t,r),n===t)return{content:e,location:null};var o,l=function(e,n){return[f(n[0])].concat((0,i.Z)(n.slice(1))).reduce(d,e)}(e,o=t>n?r.slice(n,t).map((function(e){return e.op.map((function(e){return"object"===typeof e?{d:(0,a.strPosToUni)(e.d)}:e}))})):s(r.slice(t,n).reverse()));return{content:l,location:function(e,n){var t=0,r=!0,i=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var s=l.value;if("number"!==typeof s)break;t+=s}}catch(d){i=!0,o=d}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}var c=(0,a.uniToStrPos)(n.document,t),f=c;return n.unicode&&(f=t),f-(n.dropCrlf?n.document.slice(0,c).split("\r\n").length-1:0)}(o[o.length-1],{unicode:!1,document:l,dropCrlf:!0})}}function v(e,n){if(e<0)throw new Error("Version number cannot be negative.");if(e>n.length)throw new Error("Version number ".concat(e," cannot be greater than the number of edits ").concat(n.length,"."));return!0}},50522:function(e,n,t){"use strict";t.d(n,{t:function(){return o}});var r=t(67294);function i(e){if(e<0)throw new Error('Require at least zero ops to compute pace, got "'+e+'"');return 1/Math.log(e+2)*100}function o(e,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i,l=(0,r.useState)(!1),a=l[0],u=l[1],s=(0,r.useCallback)((function(){n(1)}),[n]),c=(0,r.useCallback)((function(){e+1>t?u(!1):n(e+1)}),[n,e,t]),f=function(){u(!0)},d=function(){u(!1)};return(0,r.useEffect)((function(){if(a){var e=setTimeout((function(){c()}),o(t));return function(){return clearTimeout(e)}}}),[a,c,o,t]),{isPlaying:a,start:f,stop:d,reset:s}}},90123:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(47568),i=t(34051),o=t.n(i),l=t(67294),a=t(11163),u=t.n(a),s=t(25602);function c(e){var n=e.currentDeeplink,t=e.onChange,i=e.fs,a=e.enabled,c=(0,l.useRef)(!1),f=(0,l.useCallback)((0,r.Z)(o().mark((function e(){var n,r,l,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.current){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,s.mv)(i);case 4:if(n=e.sent,r=n.path,l=n.line,a=n.col,r){e.next=11;break}return t(null),e.abrupt("return");case 11:t({path:r,line:l,col:a});case 12:case"end":return e.stop()}}),e)}))),[i,t]),d=(0,l.useState)(!1),h=d[0],v=d[1];(0,l.useEffect)((function(){h||f().then((function(){return v(!0)}))})),(0,l.useEffect)((function(){if(a)return window.addEventListener("hashchange",f),function(){window.removeEventListener("hashchange",f)}}),[a,f]),(0,l.useEffect)((function(){if(a&&n){var e=(0,s.YM)(n),t=u().asPath;try{t=window.decodeURI(t)}catch(i){}if(!t.endsWith(e)){var r=u().asPath.includes("#")?u().asPath.slice(0,u().asPath.indexOf("#")):u().asPath;c.current=!0,u().push({pathname:u().pathname,query:u().query},"".concat(r).concat(e),{shallow:!0}),c.current=!1}}}),[i,n,a])}},54568:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(26042),i=t(10253),o=t(67294),l=t(77402);function a(e,n){return(0,r.Z)({},e,n)}var u={isLoading:!1,result:null,error:null,fileViewerType:null};function s(e){var n=e.fs,t=e.path,r=(0,i.Z)(o.useReducer(a,u),2),s=r[0],c=r[1];return o.useEffect((function(){if(t){var e=!1,r=(0,l.V)(t);return c({isLoading:!0,fileViewerType:r}),n.readFile(t).then((function(n){e||(n.error?c({isLoading:!1,result:null,error:{path:t,fileViewerType:r,error:n.error}}):c({isLoading:!1,result:{path:t,fileViewerType:r,content:n.content},error:null}))})),function(){e=!0}}c(u)}),[n,t]),s}},54677:function(e,n,t){"use strict";t.d(n,{JU:function(){return d},qC:function(){return f}});var r=t(26042),i=t(7297),o=t(31230),l=t(37887),a=t(73359);function u(){var e=(0,i.Z)(["\n  query WorkspaceHeaderUsersOnline($ids: [Int!]!) {\n    currentUser {\n      id\n    }\n    usersByIds(ids: $ids) {\n      id\n      username\n      image\n    }\n  }\n"]);return u=function(){return e},e}var s={},c=(0,o.Ps)(u());function f(e){var n=(0,r.Z)({},s,e);return l.a(c,n)}function d(e){var n=(0,r.Z)({},s,e);return a.t(c,n)}},43832:function(e,n,t){"use strict";t.d(n,{I$:function(){return Z},Du:function(){return y},Cd:function(){return x}});var r=t(26042),i=t(7297),o=t(31230),l=t(9523),a=t(52008),u=t(65711),s=t(6695);function c(){var e=(0,i.Z)(["\n  fragment ReplEnvironmentHeaderLeftCurrentUser on CurrentUser {\n    id\n    isFirewallMode\n  }\n"]);return c=function(){return e},e}function f(){var e=(0,i.Z)(["\n  fragment ReplEnvironmentHeaderLeftRepl on Repl {\n    id\n    isAlwaysOn\n    slug\n    url\n    ...WorkspaceHeaderReplMetadataRepl\n  }\n  ","\n"]);return f=function(){return e},e}var d=(0,o.Ps)(c()),h=(0,o.Ps)(f(),s.s),v=t(37887);function p(){var e=(0,i.Z)(['\n  fragment ReplEnvironment2CurrentUser on CurrentUser {\n    id\n    image\n    isFirewallMode\n    ...CrosisContextCurrentUser\n    ...ReplEnvironment2CurrentUserLayoutFlags\n    editorPreferences {\n      ...CurrentUserPreferences\n    }\n    flagFiletreeSearch: gate(feature: "flag-filetree-search")\n    ...ReplEnvironmentHeaderLeftCurrentUser\n  }\n  ',"\n  ","\n  ","\n  ","\n"]);return p=function(){return e},e}function g(){var e=(0,i.Z)(["\n  fragment ReplEnvironment2Repl on Repl {\n    id\n    title\n    layoutState\n    description\n    multiplayers {\n      id\n    }\n    currentUserPermissions {\n      containerWrite\n    }\n    origin {\n      id\n    }\n    language\n    config {\n      isVnc\n      isServer\n    }\n    lesson {\n      id\n    }\n    ...CrosisContextRepl\n    ...ReplEnvironmentHeaderLeftRepl\n  }\n  ","\n  ","\n"]);return g=function(){return e},e}function m(){var e=(0,i.Z)(["\n  query ReplEnvironment2($url: String!) {\n    repl(url: $url) {\n      ... on Repl {\n        id\n        ...CrosisContextRepl\n        ...ReplEnvironment2Repl\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n        isOwner\n      }\n    }\n    currentUser {\n      id\n      ...ReplEnvironment2CurrentUser\n    }\n  }\n  ","\n  ","\n  ","\n"]);return m=function(){return e},e}var w={},Z=(0,o.Ps)(p(),l.D,a.SL,u.wO,d),y=(0,o.Ps)(g(),l.C,h),b=(0,o.Ps)(m(),l.C,y,Z);function x(e){var n=(0,r.Z)({},w,e);return v.a(b,n)}},98269:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Xe}});var r=t(35944),i=t(51438),o=t(28668),l=t(26042),a=t(25171),u=t(99336),s=t(67294),c=t(22862),f=t(25108),d=function(e){(0,o.Z)(t,e);var n=(0,a.Z)(t);function t(){var e;return(0,i.Z)(this,t),(e=n.apply(this,arguments)).state={error:null,errorInfo:null,sentryId:null},e}var s=t.prototype;return s.componentDidCatch=function(e,n){var t,r,i=(0,u.ZP)(e,{tags:null!==(t=this.props.tags)&&void 0!==t?t:{},extras:(0,l.Z)({errorInfo:n},null!==(r=this.props.extras)&&void 0!==r?r:{})});this.setState({error:e,errorInfo:n,sentryId:i}),this.props.handleError&&this.props.handleError(e,n,i),f.error({error:e,errorInfo:n,sentryId:i})},s.render=function(){var e=this;return this.state.error?(0,r.tZ)(c.Z,{eventId:this.state.sentryId,devHide:function(){e.setState({error:null,errorInfo:null,id:null})}}):this.props.children},t}(s.Component),h=t(67903),v=t(93058),p=t(21131),g=t(45528),m=t(2858),w=t(45589),Z=t(92364),y=t(35621),b=t(7297),x=t(31230),C=t(9523),k=t(43832),P=t(37887);function S(){var e=(0,b.Z)(["\n  query ReplHistory2($url: String!) {\n    repl(url: $url) {\n      ... on Repl {\n        id\n        ...CrosisContextRepl\n        ...ReplEnvironment2Repl\n        currentUserPermissions {\n          containerWrite\n          viewHistory\n        }\n      }\n    }\n    currentUser {\n      id\n      ...ReplEnvironment2CurrentUser\n    }\n  }\n  ","\n  ","\n  ","\n"]);return S=function(){return e},e}var E={},R=(0,x.Ps)(S(),C.C,k.Du,k.I$);var T=t(11163),L=t(78539),B=t(47568),I=t(69396),U=t(99534),N=t(10253),G=t(34051),X=t.n(G),D=t(68368),O=t(96189),_=t(90123),H=t(15085),W=t(80380),F=t(99408),A=(0,t(70917).iv)("position:relative;overflow-y:auto;width:100%;height:100%;font-size:14px;background-color:var(--background-default);> div{display:flex;align-items:stretch;width:100%;height:100%;}> div > .cm-editor{flex:1 1 auto;width:100%;/* This ensures that .cm-editor doesn't overflow and handles horizontal scrolling internally */}");function V(e){var n=e.children;return(0,r.tZ)("div",{className:"editor",css:[A],children:n})}var M=t(41709);function q(e){var n=e.leftCode,t=e.rightCode,i=e.filePath,o=e.selectedVersion,l=(0,M.J)({left:{code:n,filePath:i},right:{code:t,filePath:i}}),a=l.left,u=l.right;return(0,r.BX)(H.G7,{css:[H.l0.rowWithGap(8),H.l0.flex.growAndShrink(1)],children:[(0,r.BX)(H.G7,{css:[H.l0.flex.growAndShrink(1),{flexBasis:0}],children:[(0,r.BX)(H.xv,{variant:"subheadDefault",css:[H.l0.pb(4)],children:["Version ",o]}),(0,r.tZ)(V,{children:(0,r.tZ)(M.q,{diffViewer:a})})]}),(0,r.BX)(H.G7,{css:[H.l0.flex.growAndShrink(1),{flexBasis:0}],children:[(0,r.tZ)(H.xv,{variant:"subheadDefault",css:[H.l0.pb(4)],children:"Latest Version"}),(0,r.tZ)(V,{children:(0,r.tZ)(M.q,{diffViewer:u})})]})]})}var j=t(54568),z=t(58794),J=t(48551),Y=t(63872);function $(e){var n=e.content,t=e.mime;return n?(0,r.tZ)(Y.A,{content:n,mime:t}):(0,r.tZ)(H.xv,{children:"No preview for this media file available."})}var K=t(14456),Q=t(80159);function ee(e){var n=function(e,n,t){var r=(0,Q.Z)({readOnly:!0,filePath:n}),i=r.view,o=r.ref;return(0,s.useEffect)((function(){i&&i.dispatch({changes:{from:0,to:i.state.doc.length,insert:e}})}),[i,e]),(0,s.useEffect)((function(){i&&t&&i.dispatch({effects:K.tk.scrollIntoView(t,{yMargin:10})})}),[i,t]),o}(e.content,e.filePath,e.scrollLocation);return(0,r.tZ)(V,{children:(0,r.tZ)("div",{ref:n})})}function ne(e){var n=e.media,t=e.comparison,i=e.scrubbable;return n?(0,r.tZ)("div",{css:[{width:"100%",height:"100%"},H.l0.textAlign.center],children:(0,r.tZ)($,(0,l.Z)({},n))}):t?(0,r.tZ)(q,(0,l.Z)({},t)):(0,r.tZ)(ee,(0,l.Z)({},i))}function te(e){var n=e.media,t=e.comparison,i=e.scrubbable;return(0,r.tZ)(d,{tags:{source:"replHistory2",type:"viewer-boundary"},extras:{mediaMime:null===n||void 0===n?void 0:n.mime,comparison:t,scrubbable:i},handleError:function(){window.location.hash=""},children:(0,r.tZ)(ne,{media:n,comparison:t,scrubbable:i})})}var re=t(26451),ie=t(519),oe=t(96199),le=t(25602),ae=t(61193),ue=t(54677),se=t(23600),ce=t(61957);function fe(e){var n,t,i,o,l,a,u,s=e.selectedVersion,c=e.edits;return(null===window||void 0===window||null===(n=window.location)||void 0===n||null===(t=n.search)||void 0===t?void 0:t.includes("debug=1"))?(0,r.BX)(H.G7,{css:[H.l0.rowWithGap(16),H.l0.justify.start,H.l0.pt(16),H.l0.p(8),H.l0.mb(8),H.l0.backgroundColor.redDimmest,H.l0.font.code,H.l0.overflow("hidden"),H.l0.overflowX("auto")],children:[(0,r.BX)(H.G7,{children:[(0,r.tZ)("strong",{children:"Debug view"}),(0,r.BX)(H.G7,{children:["Current Version: ",s," / ",c.length]}),(0,r.BX)(H.G7,{children:["User ID: ",c[s-1].userId]}),(0,r.BX)(H.G7,{children:["Timestamp: ",c[s-1].timestamp]})]}),(0,r.BX)(H.G7,{css:[H.l0.flex.grow(1)],children:[(0,r.BX)(H.xv,{children:["Prev Op: ",null!==(a=JSON.stringify(null===(i=c[s-2])||void 0===i?void 0:i.op))&&void 0!==a?a:"N/A"]}),(0,r.BX)(H.xv,{css:[H.l0.pt(4),H.l0.pb(4)],children:["Current Op:",(0,r.tZ)("br",{})," ",JSON.stringify(null===(o=c[s-1])||void 0===o?void 0:o.op)]}),(0,r.BX)(H.xv,{children:["Next Op: ",null!==(u=JSON.stringify(null===(l=c[s])||void 0===l?void 0:l.op))&&void 0!==u?u:"N/A"]})]})]}):null}var de=t(4275);function he(e){var n,t,i=(0,T.useRouter)().query,o=i.slug?i.slug.toString():null,a=i.username?i.username.toString():null;return(0,r.tZ)(H.ZP,(0,I.Z)((0,l.Z)({},e),{iconLeft:(0,r.tZ)(de.Z,{}),text:null!==(n=e.text)&&void 0!==n?n:"Return to Workspace",href:"/@".concat(a,"/").concat(o)+(null!==(t=window.location.hash)&&void 0!==t?t:"")}))}var ve=t(29163),pe=t(502);var ge=t(50522);function me(e){var n=e.isPlaying,t=e.onClick,i=n?pe.Pause:pe.Play,o=n?"Pause":"Play";return(0,r.tZ)(ve.Z,{onClick:t,alt:o,children:(0,r.tZ)(i,{})})}function we(e){var n=e.selectedVersion,t=e.edits,i=e.onChange,o=(0,ge.t)(n,i,t.length),l=o.isPlaying,a=o.start,u=o.stop,c=o.reset,f=function(e){l&&u();var r=Math.min(Math.max(n+e,1),t.length);i(r)};return function(e){var n=e.onLeft,t=e.onRight,r=e.onUp,i=e.onDown,o=function(e){var o=e.key;if("INPUT"!==e.target.tagName)switch(o){case"ArrowDown":i&&i();break;case"ArrowUp":r&&r();break;case"ArrowLeft":n&&n();break;case"ArrowRight":t&&t()}};s.useEffect((function(){return window.addEventListener("keydown",o),function(){window.removeEventListener("keydown",o)}}))}({onLeft:function(){f(-1)},onRight:function(){f(1)}}),1===t.length?(0,r.tZ)("p",{css:[H.l0.textAlign.center],children:"We don't have any explorable history for this file."}):(0,r.BX)(r.HY,{children:[(0,r.tZ)(me,{onClick:function(){l?u():(n===t.length&&c(),a())},isPlaying:l}),(0,r.tZ)("input",{css:H.l0.flex.grow(1),type:"range",min:"1",max:t.length,value:n,onChange:function(e){var n=e.currentTarget.value;u(),i(Number(n))}}),(0,r.BX)(H.xv,{css:[H.l0.maxWidth(100)],children:[n,"/",t.length]})]})}var Ze=t(34288),ye=function(e){var n=e.children;return(0,r.tZ)(H.G7,{css:[H.l0.flex.grow(2),H.l0.p(16),H.l0.center],children:n})};function be(){return(0,r.tZ)(ye,{children:(0,r.tZ)(H.xv,{children:"No history found for this file."})})}function xe(){return(0,r.BX)(ye,{children:[(0,r.tZ)(H.xv,{children:"Please select a file."}),(0,r.tZ)(H.xv,{children:"\ud83d\udc48 \ud83d\udc48 \ud83d\udc48 "})]})}function Ce(){return(0,r.tZ)(ye,{children:(0,r.tZ)(H.xv,{children:"Restoring and reloading."})})}function ke(){return(0,r.tZ)(ye,{children:(0,r.tZ)(H.xv,{children:"Loading..."})})}function Pe(){return(0,r.tZ)(H.G7,{css:[H.l0.height("100vh"),H.l0.center],children:(0,r.tZ)(H.G7,{css:[H.l0.maxWidth("400px")],children:(0,r.BX)(ye,{children:[(0,r.tZ)(H.xv,{multiline:!0,css:[H.l0.textAlign.center],children:"Something unexpected happened, maybe there's no Repl here or maybe you don't have access to it. You can try refreshing or use the navigation below."}),(0,r.BX)(H.G7,{css:[H.l0.p(16),H.l0.rowWithGap(8)],children:[(0,r.tZ)(H.ZP,{iconLeft:(0,r.tZ)(Ze.Z,{}),text:"Home",href:"/"}),(0,r.tZ)(he,{})]})]})})})}var Se=t(86292),Ee=t(58360),Re=function(e){(0,Se.j)(Se.U3.HISTORY_USED,{action:e,which:2})};function Te(e){var n=e.className,t=e.confirmTitle,i=e.confirmLabel,o=e.onConfirm,a=e.children,u=(0,U.Z)(e,["className","confirmTitle","confirmLabel","onConfirm","children"]),c=(0,s.useState)(!1),f=c[0],d=c[1];return(0,r.BX)(r.HY,{children:[(0,r.tZ)(H.u_,{isOpen:f,onRequestClose:function(){return d(!1)},children:(0,r.tZ)(D.Z,{onConfirm:function(){d(!1),o()},onCancel:function(){return d(!1)},title:t,confirmLabel:i,children:a})}),(0,r.tZ)(H.zx,(0,l.Z)({className:n,onClick:function(){return d(!0)}},u))]})}function Le(e){var n,t,i=e.edit,o=e.path,l=e.small,a=(0,ue.qC)({variables:{ids:[i.userId]},skip:!i.userId}).data;return(0,r.BX)(H.G7,{css:[H.l0.rowWithGap(16),H.l0.align.center,H.l0.pb(8)],children:[i.userId?(0,r.tZ)(H.n5,{src:(null===(n=null===a||void 0===a?void 0:a.usersByIds[0])||void 0===n?void 0:n.image)||null,username:(null===(t=null===a||void 0===a?void 0:a.usersByIds[0])||void 0===t?void 0:t.username)||"Loading user",localRole:l?void 0:"Author"}):(0,r.tZ)("div",{children:i.timestamp>se.p?(0,r.tZ)(H.n5,{src:"/public/images/logo-modern-small.png",username:"Your Repl",localRole:l?void 0:"Server Authored"}):(0,r.tZ)(H.n5,{src:"/public/images/ghost.svg",username:"Unknown Author",localRole:void 0})}),(0,r.tZ)(H.xv,{children:(0,r.tZ)(W.Z,{dateFormat:"switch",date:i.timestamp})}),l?null:(0,r.tZ)(H.xv,{css:[H.l0.font.code],children:o})]})}function Be(e){var n=e.filePath,t=e.small,i=(0,F.Z)().fs,o=(0,ae.c)("flag-rollout-history-2-diff-views"),l=o.enabled,a=o.loading,u=l&&!a,c=(0,s.useState)(!0),f=c[0],d=c[1],h=(0,s.useState)(!1),v=h[0],p=h[1],g=(0,s.useState)(null),m=g[0],w=g[1],Z=(0,s.useState)(""),y=Z[0],b=Z[1],x=(0,s.useState)({text:"",version:0}),C=x[0],k=x[1],P=(0,s.useState)(0),S=P[0],E=P[1],R=(0,s.useState)(0),T=R[0],L=R[1],I=function(e,n){var t=(0,j.Z)({fs:e,path:n});if(t.result&&(0,J.T3)(t.result.path))return{content:z.Z.from(t.result.content).toString("base64"),mime:(0,J.yC)(t.result.path)}}(i,n),U=!t&&u,N=U&&v?{leftCode:C.text,rightCode:y,filePath:n,selectedVersion:S}:void 0,G={content:C.text,filePath:n,scrollLocation:T};(0,s.useEffect)((function(){d(!0);var e=i.watchOtFile(n,{onReady:function(){var e=(0,B.Z)(X().mark((function e(n){var t,r,i,o;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.fetchOps,r=n.version,i=n.initialContent,!(r<1)){e.next=8;break}return E(0),k({text:"",version:0}),b(""),w(null),d(!1),e.abrupt("return");case 8:return e.next=10,t(1,r);case 10:o=e.sent,E(r),k({text:i.toString(),version:r}),b(i.toString()),w((0,ce.HJ)(o)),d(!1);case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()});return function(){e(),w(null),d(!1)}}),[n,i]);var D=(0,s.useState)(!1),O=D[0],_=D[1],W=(0,s.useState)(null),A=W[0],V=W[1];function M(){return M=(0,B.Z)(X().mark((function e(){return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_(!0),Re("versionRestored"),i.watchOtFile(n,{onReady:function(){var e=(0,B.Z)(X().mark((function e(n){var t,r,o,l,a;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.writeOp,r=n.fetchOps,o=n.version,e.prev=1,e.next=4,r(1,o);case 4:if(l=e.sent,a=(0,ce.HJ)(l)){e.next=8;break}throw new Error("Panic: received an instruction to restore with no edits to restore from.");case 8:return e.next=10,t((0,ce.UK)(S,a),{isUnicode:!0});case 10:return e.next=12,i.flush();case 12:window.location.reload(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),_(!1),V(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(n){return e.apply(this,arguments)}}()});case 3:case"end":return e.stop()}}),e)}))),M.apply(this,arguments)}if(A)throw A;return O?(0,r.tZ)(Ce,{}):f?(0,r.tZ)(ke,{}):m?(0,r.BX)(H.G7,{css:{height:"100%",width:"100%"},children:[(0,r.BX)(H.G7,{css:[H.l0.pt(16),H.l0.colWithGap(8)],children:[(0,r.tZ)(H.G7,{css:[H.l0.rowWithGap(16),H.l0.justify.spaceBetween,H.l0.center,H.l0.pb(8)],children:(0,r.tZ)(we,{onChange:function(e){if(!m)throw new Error("Received version change without any edits.");p(!1),E(e),k((function(n){var t=n.text,r=n.version,i=(0,ce.ZK)(t,r,e,m),o=i.content,l=i.location;return null!==l&&L(l),{text:o,version:e}}))},selectedVersion:S,edits:m})}),I?null:(0,r.BX)(H.G7,{css:[H.l0.rowWithGap(16),H.l0.flex.wrap,H.l0.justify.spaceBetween],children:[(0,r.tZ)(Le,{small:t,path:n,edit:m[S-1]}),(0,r.BX)(H.G7,{css:[H.l0.rowWithGap(8),t?H.l0.flex.grow(1):null],children:[U&&S!==m.length?(0,r.BX)(H.G7,{css:[H.l0.height(32),H.l0.rowWithGap(8),H.l0.center],children:[(0,r.tZ)(H.xv,{children:"Compare"}),(0,r.tZ)(ie.Z,{isOn:v,onChange:function(){v||Re("diffPreviewed"),p((function(e){return!e}))}})]}):null,(0,r.tZ)(Te,{disabled:S===m.length,text:"Restore to ".concat(S),css:t?[H.l0.flex.grow(1)]:[],onConfirm:function(){return M.apply(this,arguments)},confirmTitle:t?"Confirm restore?":"Are you sure you would like to restore?",confirmLabel:"Restore",children:(0,r.BX)(H.xv,{multiline:!0,children:["You can always restore back to the current version"," ",(0,r.tZ)(H.ZM,{children:m.length}),"."]})})]})]}),(0,r.tZ)(H.G7,{children:(0,r.tZ)(fe,{edits:m,selectedVersion:S})})]}),(0,r.tZ)(te,{media:I,comparison:N,scrubbable:G})]}):(0,r.tZ)(be,{})}var Ie=H.KD.div;function Ue(){var e=(0,N.Z)(function(){var e=(0,F.Z)(),n=e.fs,t=e.session,r=(0,s.useState)(null),i=r[0],o=r[1];return(0,s.useEffect)((function(){var e=(0,le.mv)(n);(0,B.Z)(X().mark((function n(){var r;return X().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e;case 2:(r=n.sent).path&&(o(r.path),t.openFile(r.path));case 4:case"end":return n.stop()}}),n)})))()}),[n,t]),(0,_.Z)({fs:n,currentDeeplink:(0,s.useMemo)((function(){return i?{path:i}:void 0}),[i]),onChange:function(e){e&&o(e.path)},enabled:!0}),[i,o]}(),2),n=e[0],t=e[1],i=(0,s.useState)(!0),o=i[0],a=i[1],u=(0,s.useState)(!(0,le.u9)()),c=u[0],f=u[1],h=(0,O.Z)((function(e){void 0!==e.width&&(e.width<=500?a(!0):(a(!1),f(!0)))})),v=o?"100%":325,p=(0,Ee.p)(),g=p.openFile,m=s.useCallback((function(e,n){g(e,n),t(e),Re("fileSelected"),o&&f(!1)}),[t,o,g]),w=(0,I.Z)((0,l.Z)({},p),{activeFile:n,openFile:m});return(0,s.useEffect)((function(){Re("historyLoaded")}),[]),(0,r.tZ)(H.Tg,{children:(0,r.BX)(Ie,{ref:function(e){h(e)},css:[H.l0.rowWithGap(8),{height:"100vh",width:"100vw"}],children:[(0,r.BX)(H.Tg,{elevated:!0,css:[H.l0.width(c?v:56),H.l0.p(8),o?{position:"fixed",zIndex:30,height:"100vh"}:null,{overflow:"hidden",transition:"width 180ms"}],children:[(0,r.BX)(H.G7,{css:c?[H.l0.rowWithGap(8),H.l0.justify.spaceBetween,H.l0.pb(8)]:[H.l0.colWithGap(8)],children:[o||!c?(0,r.tZ)(H.zx,{disabled:c&&null===n,iconLeft:(0,r.tZ)(re.Z,{}),text:c?"Hide files":"",onClick:function(){return f((function(e){return!e}))}}):null,(0,r.tZ)(he,{text:c?"Return to Workspace":"",colorway:"primary",css:H.l0.flex.grow(1)})]}),c?(0,r.tZ)(oe.Z,{readOnly:!0,showResources:!1,filetreeApi:w}):null]}),(0,r.tZ)(H.G7,{css:[H.l0.flex.growAndShrink(1),H.l0.pr(8),{height:"100vh"},H.l0.ml(o?64:0)],children:(0,r.tZ)(d,{tags:{source:"replHistory2",type:"inner-boundary"},extras:{activeFile:n,smallScreen:o,isFileTreeOpen:c},handleError:function(){t(""),window.location.hash=""},children:n?(0,r.tZ)(Be,{small:o,filePath:n},n):(0,r.tZ)(xe,{})})})]})})}var Ne=t(25108);function Ge(){var e,n=(0,T.useRouter)().query,t=n.slug?n.slug.toString():null;if(!t)throw new Error("Expected slug");var i=n.username?n.username.toString():function(){var e,n,t=null===window||void 0===window||null===(e=window.location)||void 0===e||null===(n=e.pathname)||void 0===n?void 0:n.split("/")[1];return t.startsWith("@")?t.substring(1):null}();if(!i)throw new Error("Expected username");var o=(0,v.Z)().showError,a=function(e){var n=(0,l.Z)({},E,e);return P.a(R,n)}({variables:{url:"/@".concat(i,"/").concat(t)}}),u=a.data,c=a.loading,f=a.error,d=(0,s.useState)((function(){return(0,w.Z)({onUnrecoverableError:function(e){Ne.error(e),o("Unfortunately, something unexpected happened. You can try reloading or returning to the Workspace.")}})}))[0],b=(0,g.b)("Repl"===(null===u||void 0===u?void 0:u.repl.__typename)?{repl:u.repl,currentUser:u.currentUser||void 0}:null);(0,s.useEffect)((function(){b&&d.container.connect({context:b})}),[d,b]);var x=(0,p.Z)((function(){return!u||f||"Repl"!==u.repl.__typename?{id:"",language:""}:{id:u.repl.id,language:u.repl.language}}),[u,f]);return c?(0,r.tZ)(ke,{}):!u||f||"Repl"!==u.repl.__typename?(0,r.tZ)(Pe,{}):(null===(e=u.repl.currentUserPermissions)||void 0===e?void 0:e.containerWrite)?(0,r.tZ)(m.Z.Provider,{value:d,children:(0,r.tZ)(y.Z.Provider,{value:x,children:(0,r.BX)(h.Z,{title:"History",marketingHeader:!1,noHeader:!0,noFooter:!0,hideSidebar:!0,hideEmailVerify:!0,children:[(0,r.tZ)(Z.Z,{prefix:"History"}),(0,r.tZ)(Ue,{})]})})}):(0,r.tZ)(Pe,{})}var Xe=function(){return(0,r.tZ)(L.Z,{children:(0,r.tZ)(d,{tags:{source:"replHistory2",type:"outer-boundary"},children:(0,r.tZ)(Ge,{})})})}}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[3662,3443,2240,6344,8764,8063,8966,4778,5395,9998,8944,8813,7485,5499,6165,1674,4508,2027,9641,7073,7903,4286,7046,4718,2350,3497,3576,634,843,6456,6496,9774,2888,179],(function(){return n(25436),n(93061)}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=replHistory2-0fe4edb10cd89035.js.map